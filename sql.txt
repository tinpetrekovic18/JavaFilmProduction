-- Drop tables if they exist
DROP TABLE IF EXISTS ADRESA;
DROP TABLE IF EXISTS CLAN_EKIPE;
DROP TABLE IF EXISTS DISTRIBUCIJA;
DROP TABLE IF EXISTS FINANCIJE;
DROP TABLE IF EXISTS GLUMAC;
DROP TABLE IF EXISTS KORISNIK;
DROP TABLE IF EXISTS LOKACIJA_SNIMANJA;
DROP TABLE IF EXISTS PRODUCENT;
DROP TABLE IF EXISTS PRODUKCIJSKA_KUCA;
DROP TABLE IF EXISTS PROJEKT;
DROP TABLE IF EXISTS SCENA;

-- Create tables
CREATE TABLE ADRESA(
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    BROJ INT NOT NULL,
    ULICA VARCHAR(40) NOT NULL,
    GRAD VARCHAR(40) NOT NULL,
    POSTANSKI_BROJ CHAR(5) NOT NULL,
    DRZAVA VARCHAR(40) NOT NULL,
    PRIMARY KEY (ID)
);

CREATE TABLE DISTRIBUCIJA (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    POCETAK_PROJEKTA  DATE NOT NULL,
    KRAJ_PROJEKTA DATE NOT NULL,
    IZLAZAK_FILMA DATE NOT NULL,
    PRIMARY KEY (ID)
);

CREATE TABLE FINANCIJE (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    PRORACUN DECIMAL(10,2) NOT NULL,
    TROSKOVI DECIMAL(10,2) NOT NULL,
    PRIHODI DECIMAL(10,2) NOT NULL,
    PRIMARY KEY (ID)
);

CREATE TABLE ROLA (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    NAZIV_ROLE VARCHAR(10) NOT NULL,
    OPIS VARCHAR(100) NOT NULL,
    PRIMARY KEY (ID)
);


CREATE TABLE KORISNIK (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    ID_KORISNIKA VARCHAR(25) NOT NULL,
    LOZINKA VARCHAR(25) NOT NULL,
    IME VARCHAR(25) NOT NULL,
    PREZIME VARCHAR(25) NOT NULL,
    ROLA BIGINT NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (ROLA) REFERENCES ROLA(ID)
);

CREATE TABLE PRODUKCIJSKA_KUCA (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    NAZIV VARCHAR(50) NOT NULL,
    GODINA_OSNUTKA INT NOT NULL,
    SJEDISTE BIGINT NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (SJEDISTE) REFERENCES ADRESA(ID)
);


CREATE TABLE PROJEKT (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    PRODUKCIJSKA_KUCA INT NOT NULL,
    BROJ_NOMINACIJA INT NOT NULL,
    BROJ_NAGRADA INT NOT NULL,
    FINANCIJE BIGINT NOT NULL,
    DISTRIBUCIJA BIGINT NOT NULL,
    POCETAK_RADA DATE NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (PRODUKCIJSKA_KUCA) REFERENCES PRODUKCIJSKA_KUCA(ID),
    FOREIGN KEY (FINANCIJE) REFERENCES FINANCIJE(ID),
    FOREIGN KEY (DISTRIBUCIJA) REFERENCES DISTRIBUCIJA(ID)
);

CREATE TABLE LOKACIJA_SNIMANJA (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    LOKACIJA BIGINT NOT NULL,
    PROJEKT BIGINT NOT NULL,
    REZERVIRANO_OD DATE NOT NULL,
    REZERVIRANO_DO DATE NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (LOKACIJA) REFERENCES ADRESA(ID),
    FOREIGN KEY (PROJEKT) REFERENCES PROJEKT(ID)
);

CREATE TABLE CLAN_EKIPE (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    IME VARCHAR(25) NOT NULL,
    PREZIME VARCHAR(25) NOT NULL,
    OIB CHAR(11) NOT NULL,
    DOB INT NOT NULL,
    OPIS_POSLA VARCHAR(70) NOT NULL,
    TRENUTNI_PROJEKT INT NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (TRENUTNI_PROJEKT) REFERENCES PROJEKT(ID)
);
CREATE TABLE GLUMAC (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    IME VARCHAR(25) NOT NULL,
    PREZIME VARCHAR(25) NOT NULL,
    OIB CHAR(11) NOT NULL,
    DOB INT NOT NULL,
    UMJETNICKO_IME VARCHAR(30) NOT NULL,
    BROJ_NOMINACIJA INT NOT NULL,
    BROJ_NAGRADA INT NOT NULL,
    TRENUTNI_PROJEKT INT NOT NULL,
    POCETAK_RADA DATE NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (TRENUTNI_PROJEKT) REFERENCES PROJEKT(ID)
);

CREATE TABLE PRODUCENT (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    IME VARCHAR(25) NOT NULL,
    PREZIME VARCHAR(25) NOT NULL,
    OIB CHAR(11) NOT NULL,
    DOB INT NOT NULL,
    UMJETNICKO_IME VARCHAR(30) NOT NULL,
    BROJ_NOMINACIJA INT NOT NULL,
    BROJ_NAGRADA INT NOT NULL,
    TRENUTNI_PROJEKT INT NOT NULL,
    POCETAK_RADA DATE NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (TRENUTNI_PROJEKT) REFERENCES PROJEKT(ID)
);

CREATE TABLE SCENA (
    ID BIGINT GENERATED ALWAYS AS IDENTITY,
    POCETAK_SNIMANJA DATETIME NOT NULL,
    KRAJ_SNIMANJA DATETIME NOT NULL,
    LOKACIJA_SNIMANJA BIGINT NOT NULL,
    PROJEKT BIGINT NOT NULL,
    PRODUCENT BIGINT NOT NULL,
    PRIMARY KEY (ID),
    FOREIGN KEY (LOKACIJA_SNIMANJA) REFERENCES LOKACIJA_SNIMANJA(ID),
    FOREIGN KEY (PROJEKT) REFERENCES PROJEKT(ID),
    FOREIGN KEY (PRODUCENT) REFERENCES PRODUCENT(ID)
);

-- Inserting sample data into the ADRESA table
INSERT INTO ADRESA (BROJ, ULICA, GRAD, POSTANSKI_BROJ, DRZAVA)
VALUES
(123, 'Main Street', 'Los Angeles', '90001', 'USA'),
(456, 'Broadway', 'New York', '10001', 'USA');

-- Inserting sample data into the DISTRIBUCIJA table
INSERT INTO DISTRIBUCIJA (POCETAK_PROJEKTA, KRAJ_PROJEKTA, IZLAZAK_FILMA)
VALUES
('2023-01-01', '2023-06-30', '2023-12-31'),
('2023-02-01', '2023-07-31', '2023-12-31');

-- Inserting sample data into the FINANCIJE table
INSERT INTO FINANCIJE (PRORACUN, TROSKOVI, PRIHODI)
VALUES
(1000000.00, 800000.00, 1200000.00),
(1500000.00, 1000000.00, 2000000.00);

-- Inserting sample data into the ROLA table
INSERT INTO ROLA (NAZIV_ROLE, OPIS)
VALUES
('admin', 'Ova rola dopušta sve u aplikaciji'),
('user', 'Ova rola ima ograničene mogućnosti u aplikaciji');

-- Inserting sample data into the KORISNIK table
INSERT INTO KORISNIK (ID_KORISNIKA, LOZINKA, IME, PREZIME, ROLA)
VALUES
('admin', 'admin', 'admin', 'admin', 1),
('user', '123', 'Tin', 'Petreković', 2);

-- Inserting sample data into the PRODUKCIJSKA_KUCA table
INSERT INTO PRODUKCIJSKA_KUCA (NAZIV, GODINA_OSNUTKA, SJEDISTE)
VALUES
('Paramount Pictures', 1912, 1),
('Warner Bros. Pictures', 1923, 2);

-- Inserting sample data into the PROJEKT table
INSERT INTO PROJEKT (PRODUKCIJSKA_KUCA, BROJ_NOMINACIJA, BROJ_NAGRADA, FINANCIJE, DISTRIBUCIJA, POCETAK_RADA)
VALUES
(1, 5, 3, 1, 1, '2022-10-01'),
(2, 3, 2, 2, 2, '2023-01-15');

-- Inserting sample data into the LOKACIJA_SNIMANJA table
INSERT INTO LOKACIJA_SNIMANJA (LOKACIJA, PROJEKT, REZERVIRANO_OD, REZERVIRANO_DO)
VALUES
(1, 1, '2023-01-01', '2023-01-10'),
(2, 2, '2023-02-15', '2023-02-28');

-- Inserting sample data into the CLAN_EKIPE table
INSERT INTO CLAN_EKIPE (IME, PREZIME, OIB, DOB, OPIS_POSLA, TRENUTNI_PROJEKT)
VALUES
('Mark', 'Johnson', '12345678901', 35, 'Cinematographer', 1),
('Anna', 'Smith', '23456789012', 28, 'Production Designer', 2);

-- Inserting sample data into the GLUMAC table
INSERT INTO GLUMAC (IME, PREZIME, OIB, DOB, UMJETNICKO_IME, BROJ_NOMINACIJA, BROJ_NAGRADA, TRENUTNI_PROJEKT, POCETAK_RADA)
VALUES
('Tom', 'Hanks', '34567890123', 45, 'Tom Hanks', 3, 2, 1, '1990-05-15'),
('Emma', 'Stone', '45678901234', 32, 'Emma Stone', 2, 1, 2, '2005-09-20');

-- Inserting sample data into the PRODUCENT table
INSERT INTO PRODUCENT (IME, PREZIME, OIB, DOB, UMJETNICKO_IME, BROJ_NOMINACIJA, BROJ_NAGRADA, TRENUTNI_PROJEKT, POCETAK_RADA)
VALUES
('Steven', 'Spielberg', '56789012345', 55, 'Steven Spielberg', 6, 4, 1, '1980-03-10'),
('Christopher', 'Nolan', '67890123456', 50, 'Christopher Nolan', 4, 3, 2, '1995-07-25');

-- Inserting sample data into the SCENA table
INSERT INTO SCENA (POCETAK_SNIMANJA, KRAJ_SNIMANJA, LOKACIJA_SNIMANJA, PROJEKT, PRODUCENT)
VALUES
('2023-01-02 08:00:00', '2023-01-05 18:00:00', 1, 1, 1),
('2023-02-20 10:30:00', '2023-02-25 20:00:00', 2, 2, 2);




